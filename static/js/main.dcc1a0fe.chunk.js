(this["webpackJsonpmarrinetraffic-pk"]=this["webpackJsonpmarrinetraffic-pk"]||[]).push([[0],{22:function(e,t,a){e.exports=a(34)},27:function(e,t,a){},28:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(14),s=a.n(i),o=(a(27),a(6)),c=a(11),l=a(10),u=a(8),m=a(9),h=a(12),d=(a(28),a(40)),p=a(36),v=a(37),f=a(38),y=a(39),k=a(41);"undefined"===typeof Number.prototype.toRadians&&(Number.prototype.toRadians=function(){return this*Math.PI/180}),"undefined"===typeof Number.prototype.toDegrees&&(Number.prototype.toDegrees=function(){return this*(180/Math.PI)});var g=6371e3,b=function(e,t,a){var n=function(e,t,a,n){var r=e.toRadians(),i=a.toRadians(),s=(a-e).toRadians(),o=(n-t).toRadians(),c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(r)*Math.cos(i)*Math.sin(o/2)*Math.sin(o/2),l=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return g*l}(e[0],e[1],t[0],t[1]),r=function(e,t,a,n){var r=e.toRadians(),i=a.toRadians(),s=(n-t).toRadians(),o=Math.sin(s)*Math.cos(i),c=Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(s);return Math.atan2(o,c).toDegrees()}(e[0],e[1],t[0],t[1]);return function(e,t,a,n){var r=e.toRadians(),i=t.toRadians(),s=a,o=n.toRadians(),c=Math.asin(Math.sin(r)*Math.cos(s/g)+Math.cos(r)*Math.sin(s/g)*Math.cos(o)),l=i+Math.atan2(Math.sin(o)*Math.sin(s/g)*Math.cos(r),Math.cos(s/g)-Math.sin(r)*Math.sin(c));return[c.toDegrees(),l.toDegrees()]}(e[0],e[1],n*a,r)},E="https://services.marinetraffic.com/api",M="exportvesseltrack",P="86851603dd8eb2766a7e164bf79fbddeaea5014d",C={INITIAL:0,PLAY:1,PAUSE:2,REPLAY:3},S=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).animationPlaying=!1,a.data=null,a.state={loading:!1,error:!1,errorMessage:"",showVesselMarker:!1,showVesselTrackMarkers:!1,vessel:null,vesselCurrentTrack:null,vesselTracks:[],clusteringPositions:[],mapPosition:[37.946163,23.629808],zoom:10,bounds:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.trackData&&e.trackData.length>0&&(e.animationStatus===C.INITIAL&&(this.data=e.trackData,this.initStateData(e.trackData),this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)),e.animationStatus===C.PLAY&&(this.animationPlaying=!0,this.intervalId||this.animate()),e.animationStatus===C.PAUSE&&(this.animationPlaying=!1),e.animationStatus===C.REPLAY&&(this.initStateData(e.trackData),this.animationPlaying=!0,this.intervalId&&clearInterval(this.intervalId),this.animate()))}},{key:"initStateData",value:function(e){this.intervalId&&clearInterval(this.intervalId);var t=[Math.max.apply(Math,Object(h.a)(e.map((function(e){return e.lat})))),Math.max.apply(Math,Object(h.a)(e.map((function(e){return e.lon}))))],a=[Math.min.apply(Math,Object(h.a)(e.map((function(e){return e.lat})))),Math.min.apply(Math,Object(h.a)(e.map((function(e){return e.lon}))))],n=Object(h.a)(e).pop();this.setState({vessel:{track:n},showVesselMarker:!0,clusteringPositions:[],loading:!1,bounds:[t,a],vesselCurrentTrack:null,vesselTracks:[],showVesselTrackMarkers:!0})}},{key:"animate",value:function(){var e=this,t=0,a=0,n=this.state,r=n.clusteringPositions,i=n.vesselTracks,s=this.data;i.push(s[a]),this.intervalId=setInterval((function(){if(e.animationPlaying){if(a>=s.length-1)return clearInterval(e.intervalId),void e.setState({vesselCurrentTrack:null});if(t>=1)return a++,i.push(s[a]),void(t=0);var n=s[a].mapPosition,o=s[a+1].mapPosition,c=b(n,o,t);r.push(c),e.setState({vesselCurrentTrack:c,clusteringPositions:r,vesselTracks:Object(h.a)(i),showVesselTrackMarkers:!0}),t+=.01}}),32)}},{key:"renderPopup",value:function(e){var t=e.timestamp,a=e.speed;return r.a.createElement(d.a,null,"Date: ",t," ",r.a.createElement("br",null),"Speed: ",a,"Knts")}},{key:"renderVesselInfo",value:function(e){return r.a.createElement(p.a,{position:e.track.mapPosition},this.renderPopup(e.track))}},{key:"renderVesseTrack",value:function(e,t){return r.a.createElement(v.a,{key:t,center:e.mapPosition,radius:5},this.renderPopup(e))}},{key:"renderVesselTrackCluster",value:function(e){if(e&&0!==e.length){var t=Object(h.a)(e);return r.a.createElement(f.a,{color:"white",positions:t})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.bounds,n=t.zoom,i=t.mapPosition,s=t.showVesselMarker,o=t.vesselCurrentTrack,c=t.vessel,l=t.showVesselTrackMarkers,u=t.clusteringPositions,m=t.vesselTracks;return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{bounds:a,duration:2,easeLinearity:.25,animate:!0,center:i,zoom:n},r.a.createElement(k.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s?this.renderVesselInfo(c):null,l?this.renderVesselTrackCluster(u):null,l?m.map((function(t,a){return e.renderVesseTrack(t,a)})):null,o?r.a.createElement(v.a,{color:"red",center:o,radius:10}):null))}}]),t}(n.Component),I=function(e){return Object.keys(e).map((function(t,a){return"".concat(t,":").concat(e[t])})).join("/")},O=function(e){var t=e.apiEndpoint,a=e.apiKey,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},i="".concat(E,"/").concat(t,"/").concat(a,"/").concat(I(n));return i="mocks/".concat(t,".json"),console.log("Mock is enabled fecting data from: ".concat(i)),fetch(i,r).then((function(e){return e.json()})).catch((function(e){return e.json()})).then((function(e){if(e.errors)throw e.errors;return e}))},j=function(e){function t(e){var a,n=e.MMSI,r=e.STATUS,i=e.SPEED,s=e.LON,c=e.LAT,m=e.COURSE,h=e.HEADING,d=e.TIMESTAMP,p=e.SHIP_ID;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this))).mmsi=parseInt(n),a.status=parseInt(r),a.speed=parseInt(i),a.lon=parseFloat(s),a.lat=parseFloat(c),a.course=parseInt(m),a.heading=parseInt(h),a.timestamp=d,a.shipId=parseInt(p),a.date=new Date(a.timestamp),a.mapPosition=[a.lat,a.lon],a}return Object(m.a)(t,e),t}((function e(){Object(o.a)(this,e)})),T=(a(31),600),N=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={searchQuery:""},a.handleSubmit=function(e){e.preventDefault(),clearTimeout(a.timer),a.notifyOnQueryChange()},a.handleOnChange=function(e){clearTimeout(a.timer),a.setState({searchQuery:e.target.value},(function(){return a.timer=setTimeout(a.notifyOnQueryChange,T)}))},a.notifyOnQueryChange=function(){a.props.onQueryChange(a.state.searchQuery)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmmount",value:function(){clearTimeout(this.timer)}},{key:"render",value:function(){var e=this.state.searchQuery;return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{className:"md-input search-box",autoComplete:"off",placeholder:"MMSI: ex. 239410300",onChange:this.handleOnChange,type:"text",id:"searchQuery",value:e}))}}]),t}(n.Component),R=(a(32),function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"navigator-card-header-image"}),r.a.createElement("div",{className:"navigator-card-body"},r.a.createElement("div",{className:"md-subtitle"},"MMSI: ",e.mmsi)))}),D=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={statusPlaying:!1},a.playClicked=function(){a.props.onPlayClick(),a.setState({statusPlaying:!0})},a.renderPauseReplay=function(){var e=a.props,t=e.onPauseClick,n=e.onReplayClick;return r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("button",{className:"md-button-primary md-button-round",onClick:t},r.a.createElement("img",{src:"images/pause-24px.svg",alt:""})),r.a.createElement("button",{className:"md-button-primary md-button-round",onClick:n},r.a.createElement("img",{src:"images/replay-24px.svg",alt:""})))},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state.statusPlaying;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"md-button-primary",onClick:this.playClicked},"SHOW VESSELS TRACK"),e?this.renderPauseReplay():null)}}]),t}(n.Component),w=(a(33),function(e){return r.a.createElement("div",{className:"load-bar"},r.a.createElement("div",{className:"bar"}),r.a.createElement("div",{className:"bar"}),r.a.createElement("div",{className:"bar"}))}),A=function(e){return r.a.createElement("div",{className:"navigator-container"},e.trackData?r.a.createElement("div",{className:"navigator-card"},r.a.createElement(R,{mmsi:e.mmsi}),r.a.createElement("div",{className:"navigator-card-body"},r.a.createElement(D,{onPauseClick:e.onPauseClick,onPlayClick:e.onPlayClick,onReplayClick:e.onReplayClick}))):null,r.a.createElement("div",{className:"navigator-card"},e.loading?r.a.createElement(w,null):null,e.serverError?function(){var t=e.serverMessage;return r.a.createElement("div",{className:"md-error"},"ERROR: ",t)}():null,r.a.createElement(N,{onQueryChange:e.onSearchQueryChange})))},V=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={mmsi:0,loading:!1,serverError:!1,serverMessage:"",trackData:null,animationStatus:C.INITIAL},a.handleOnQueryChange=function(e){e&&!isNaN(e)&&(e=parseInt(e),a.setState({mmsi:e,trackData:null,loading:!0}),a.fetchVesselData(e))},a.handlePauseClick=function(){a.setState({animationStatus:C.PAUSE})},a.handlePlayClick=function(){a.setState({animationStatus:C.PLAY})},a.handleReplayClick=function(){a.setState({animationStatus:C.REPLAY})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchVesselData",value:function(e){var t=this;(function(e){return O({apiEndpoint:M,apiKey:P},{v:2,period:"daily",days:5,mmsi:e,protocol:"jsono"}).then((function(e){return e.map((function(e){return new j(e)}))}))})(e).then((function(e){t.setState({trackData:e,loading:!1,serverError:!1,animationStatus:C.INITIAL})})).catch((function(e){var a="Connection error";e.length>0&&(a=e.map((function(e){return e.detail})).join(", ")),t.setState({loading:!1,serverError:!0,serverMessage:a})}))}},{key:"render",value:function(){var e=this.state,t=e.mmsi,a=e.trackData,n=e.loading,i=e.serverError,s=e.animationStatus,o=e.serverMessage;return r.a.createElement("div",{className:"md-page-container"},r.a.createElement(A,{mmsi:t,loading:n,serverError:i,serverMessage:o,trackData:a,onSearchQueryChange:this.handleOnQueryChange,onPauseClick:this.handlePauseClick,onPlayClick:this.handlePlayClick,onReplayClick:this.handleReplayClick}),r.a.createElement(S,{animationStatus:s,trackData:a,mmsi:t}))}}]),t}(n.Component);var L=function(){return r.a.createElement(V,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.dcc1a0fe.chunk.js.map